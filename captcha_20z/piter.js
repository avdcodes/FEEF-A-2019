(function() {

    var antManThanosTruck = 1;
    var whom = document.getElementById('whom');
    var rhythmIsADancer = document.getElementById('theArtOfKanly');
    var ite = document.getElementById('ite');

    function dirtee(theEscape67) {
        var itemz = document.getElementsByClassName('itemz');
        if (theEscape67 === 'wZrdSlease') {
            if (antManThanosTruck < itemz.length) {
                antManThanosTruck++;
                rhythmIsADancer.innerText = fjvjjveolethbfnirgfbrbievVFGBNTRTEGVBGGERBRHTGEBNFRHTGEBNREG(itemz[antManThanosTruck - 1].src);
                document.getElementById('ciauehfoqehgivuhqvirhevogqeri' + (antManThanosTruck - 1)).classList.add('pain');
                document.getElementById('ciauehfoqehgivuhqvirhevogqeri' + (antManThanosTruck - 2)).classList.remove('pain');
                for (var i = 0; i < itemz.length; i++) {
                    if (itemz[i].classList.contains('phatTony')) {
                        itemz[i].classList.remove('phatTony');
                        if (itemz[i].src.indexOf('.MOV') !== -1 || itemz[antManThanosTruck - 1].src.indexOf('.mp4') !== -1) {
                            itemz[i].pause();
                        }
                    }
                }
                itemz[antManThanosTruck - 1].classList.add('phatTony');
                if (itemz[antManThanosTruck - 1].classList.contains('avd')) {
                    whom.innerText = 'avd'
                } else if (itemz[antManThanosTruck - 1].classList.contains('danni')) {
                    whom.innerText = 'danni'
                }
                if (itemz[antManThanosTruck - 1].src.indexOf('.MOV') !== -1 || itemz[antManThanosTruck - 1].src.indexOf('.mp4') !== -1) {
                    itemz[antManThanosTruck - 1].play();
                }
            }
        } else if (theEscape67 === 'babyGot') {
            if (antManThanosTruck > 1) {
                antManThanosTruck--;
                rhythmIsADancer.innerText = fjvjjveolethbfnirgfbrbievVFGBNTRTEGVBGGERBRHTGEBNFRHTGEBNREG(itemz[antManThanosTruck - 1].src);
                document.getElementById('ciauehfoqehgivuhqvirhevogqeri' + (antManThanosTruck - 1)).classList.add('pain');
                document.getElementById('ciauehfoqehgivuhqvirhevogqeri' + (antManThanosTruck)).classList.remove('pain');
                for (var i = 0; i < itemz.length; i++) {
                    if (itemz[i].classList.contains('phatTony')) {
                        itemz[i].classList.remove('phatTony');
                        if (itemz[i].src.indexOf('.MOV') !== -1 || itemz[antManThanosTruck - 1].src.indexOf('.mp4') !== -1) {
                            itemz[i].pause();
                        }
                    }
                }
                itemz[antManThanosTruck - 1].classList.add('phatTony');
                if (itemz[antManThanosTruck - 1].classList.contains('avd')) {
                    whom.innerText = 'avd';
                } else if (itemz[antManThanosTruck - 1].classList.contains('danni')) {
                    whom.innerText = 'danni'
                }
                if (itemz[antManThanosTruck - 1].src.indexOf('.MOV') !== -1 || itemz[antManThanosTruck - 1].src.indexOf('.mp4') !== -1) {
                    itemz[antManThanosTruck - 1].play();
                }
            }
        }
    }

    function fjvjjveolethbfnirgfbrbievVFGBNTRTEGVBGGERBRHTGEBNFRHTGEBNREG(xwjbcconcowwferbever) {
        var where2start = xwjbcconcowwferbever.lastIndexOf(".");
        return xwjbcconcowwferbever.slice(where2start);
    }

    function skrrt(thing) {
        if (thing.type === 'jpg' || thing.type === 'jpeg' || thing.type === 'png' || thing.type === 'JPG') {
            var xenoblade = document.createElement('img');
            xenoblade.src = 'https://s3.amazonaws.com/dannix/' + thing.filename;
            xenoblade.classList.add('itemz');
            xenoblade.classList.add(thing.who);
            xenoblade.classList.add()
            if (thing.id === 1) {
                xenoblade.classList.add('phatTony');
                whom.innerText = thing.who;
                rhythmIsADancer.innerText = fjvjjveolethbfnirgfbrbievVFGBNTRTEGVBGGERBRHTGEBNFRHTGEBNREG(thing.filename);
            }
            document.body.append(xenoblade);
        } else if (thing.type === 'mp4' || thing.type === 'mov' || thing.type === 'MOV') {
            var gundam = document.createElement('video');
            gundam.src = 'https://s3.amazonaws.com/dannix/' + thing.filename;
            gundam.setAttribute('loop', true);
            gundam.setAttribute('playsInline', true);
            gundam.classList.add('itemz');
            gundam.classList.add(thing.who);
            if (thing.id === 1) {
                gundam.classList.add('phatTony');
                whom.innerText = thing.who;
                rhythmIsADancer.innerText = fjvjjveolethbfnirgfbrbievVFGBNTRTEGVBGGERBRHTGEBNFRHTGEBNREG(thing.filename)
            }
            document.body.append(gundam);
        }
    }

    function letTheSpiceFlow(preSpiceMass) {
        var isLittleMaker = window.innerWidth;
        var garrixSux = isLittleMaker / preSpiceMass;
        for (var i = 0; i < preSpiceMass; i++) {
            var gomJabbar = document.createElement('div');
            gomJabbar.classList.add('gomJabbar');
            if (i === 0) {
                gomJabbar.classList.add('pain');
            }
            gomJabbar.id = 'ciauehfoqehgivuhqvirhevogqeri' + i;
            document.getElementById('positronic_carousel_wrap').append(gomJabbar);
        }
    }

    function longSword(dagger) {
        var isLittleMaker = window.innerWidth;
        var garrixSux = isLittleMaker / dagger;
        var gomJabbar = document.createElement('div');
        gomJabbar.classList.add('gomJabbar');
        gomJabbar.id = 'ciauehfoqehgivuhqvirhevogqeri' + dagger;
        document.getElementById('positronic_carousel_wrap').append(gomJabbar);
    }

    var thumping = false;

    function babylonBlud() {
        if (!thumping) {
            thumping = true;
            ite.style.display = 'flex';
            setTimeout(() => {
                ite.style.display = 'none';
                thumping = false;
            }, 1000)
        }
    }

    $.ajax({
        type: "GET",
        url: "/justified"
    }).done(stuff => {
        console.log(stuff.stuff);
        stuff.stuff.map(thing => {
            skrrt(thing);
        });
        letTheSpiceFlow(stuff.stuff.length);
    })

    var roooooty = io.connect('http://feef-a2019.herokuapp.com');

    roooooty.on('connect', function() {

       roooooty.on('update_content', () => {
           $.ajax({
               type: "GET",
               url: "/ancient"
           }).done(stuff => {
               var thing = stuff.last[0];
               skrrt(thing);
               longSword(stuff.last[0].id - 1);
               babylonBlud();
           })
       });

    });

    document.body.addEventListener('keydown', (yolo) => {
        if (yolo.keyCode === 37) {
            dirtee('babyGot');
        } else if (yolo.keyCode === 39) {
            dirtee('wZrdSlease');
        }
    })

    var whizzPopBang = false;
    var reconxxX;
    var bringTheBuzz;

    document.body.addEventListener('touchstart', (lmao) => {
        if (lmao.touches.length === 1) {
            reconxxX = lmao.pageX;
            bringTheBuzz = lmao.pageY;
            whizzPopBang = true;
        }
    })

    document.body.addEventListener('touchend', (rofl) => {
        if (whizzPopBang && rofl.touches.length === 0 && (rofl.pageX < reconxxX + 20 && rofl.pageX > reconxxX - 20) && (rofl.pageY < bringTheBuzz + 20 && rofl.pageY > bringTheBuzz - 20)) {
            if (rofl.pageX > window.innerWidth / 2) {
                dirtee('wZrdSlease');
            } else {
                dirtee('babyGot');
            }
            reconxxX = null;
            bringTheBuzz = null;
            whizzPopBang = false;
        }
    })


}());
